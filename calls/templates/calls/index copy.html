{% extends 'calls/base.html' %}
{% load static %}
{% block content %}
<div>
    <div class="mt-4">
        <h3>Real-Time Emergency Calls</h3>
        <div id="map"></div>
        <script>
            (g => { var h, a, k, p = "The Google Maps JavaScript API", c = "google", l = "importLibrary", q = "__ib__", m = document, b = window; b = b[c] || (b[c] = {}); var d = b.maps || (b.maps = {}), r = new Set, e = new URLSearchParams, u = () => h || (h = new Promise(async (f, n) => { await (a = m.createElement("script")); e.set("libraries", [...r] + ""); for (k in g) e.set(k.replace(/[A-Z]/g, t => "_" + t[0].toLowerCase()), g[k]); e.set("callback", c + ".maps." + q); a.src = `https://maps.${c}apis.com/maps/api/js?` + e; d[q] = f; a.onerror = () => h = n(Error(p + " could not load.")); a.nonce = m.querySelector("script[nonce]")?.nonce || ""; m.head.append(a) })); d[l] ? console.warn(p + " only loads once. Ignoring:", g) : d[l] = (f, ...n) => r.add(f) && u().then(() => d[l](f, ...n)) })
                ({ key: "AIzaSyBw092-D_-ko1ufD8EdITfvJPdnm5anTuE", v: "beta" });
        </script>
        <div style="display: none">
            <div markerid="[callId]" data-coordinates="[coordinates]" data-phone="[phone]"
                class="markerInfoWindow d-flex flex-column gap-3">
                <div>
                    Phone number: <span class="phone fw-semibold">[phone]</span>
                    <br />
                    Caller Name: <span class="callerName fw-semibold">[callername]</span>
                    <br />
                    Caller Address: <span class="callerAddress fw-semibold">[calleraddress]</span>
                    <br />
                    Call Time: <span class="callTime fw-semibold">[calltime]</span>
                    <br />
                    Distance: <span class="distance fw-semibold"></span>
                    <br />
                    Call Location: <span class="address fw-semibold"></span>
                    <br />
                    Estimated Travel Time: <span class="ett fw-semibold"></span>
                    <br />
                    Estimated Travel Time in Traffic: <span class="ettf fw-semibold"></span>
                </div>
                <div>
                    <button class="responded btn btn-sm btn-success">Responded</button>
                    <button class="track btn btn-sm btn-primary">Track</button>
                    <button class="cancel btn btn-sm btn-danger">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    <div class="mt-4">
        <h3>Call Logs</h3>
        <table class="table callLogsTable">
            <thead>
                <tr>
                    <th>Phone Number</th>
                    <th>Call Created Time</th>
                    <th>Duration</th>
                    <th>Coordinates</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <!-- {% for i in call_logs %}
                <tr>
                    <td>{{ i.number }}</td>
                    <td>{{ i.date }}</td>
                    <td>{{ i.duration }}</td>
                    <td>{{ i.coordinates }}</td>
                    <td>{{ i.status }}</td>
                </tr>
                {% endfor %} -->
            </tbody>
        </table>
    </div>
</div>
<script type="module" src="{% static 'js/index.js' %}"></script>
</div>
{% endblock %}